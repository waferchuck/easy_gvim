set nocompatible
source $VIMRUNTIME/vimrc_example.vim
source $VIMRUNTIME/mswin.vim
behave mswin

set number
set autochdir
set ai
set ignorecase
set smartcase 
set sts=4
set tabstop=4
set shiftwidth=4
set softtabstop=4
set noexpandtab
set expandtab
set cindent
"exec 'cd ' . fnameescape('D:\RTC_storage\Local_PurionH_V4.1_Int_t1008097_Workspace\Src\RealTimeApplications')
colorscheme evening
set guifont=Consolas:h12:cANSI

"set the default size of VIM
set lines=65 columns=210
"set the default window postion
winpos 360 700

map <S-h> ^
map <S-l> $
nmap <S-k> [[
inoremap <C-Space> <C-p>
inoremap <C-i> <C-]>
inoremap <expr> <Tab> getline('.')[col('.')-2] !~ '^\s\?$' \|\| pumvisible()
      \ ? '<C-N>' : '<Tab>'
inoremap <expr> <S-Tab> pumvisible() \|\| getline('.')[col('.')-2] !~ '^\s\?$'
      \ ? '<C-P>' : '<Tab>'
autocmd CmdwinEnter * inoremap <expr> <buffer> <Tab>
      \ getline('.')[col('.')-2] !~ '^\s\?$' \|\| pumvisible()
      \ ? '<C-X><C-V>' : '<Tab>'


" this will use ctrl+h as backspace
imap ^? ^H

let NERDChristmasTree=1

set guioptions-=m "disable menu bar
set guioptions-=T "disable toolbar
set guioptions-=r "disable scrollbar


" inoremap <expr> <Space> pumvisible() ? "\<C-y>" : " "

command! -nargs=+ Grep silent! grep <args> *.c *.cpp ..\Include\*.h| copen | redraw!

"command! -nargs=1 Grep silent! execute 'grep -rnI <args> --include=*.c *.cpp ..\Include\*.h' | copen


command! -nargs=+ RenameFull call RenameFullVariable(<f-args>)

function! RenameFullVariable(old_name, new_name)
    let pattern = '\<' . escape(a:old_name, '\') . '\>'
    let replace = escape(a:new_name, '\')
    execute '%s/'.pattern.'/'.replace.'/g'
endfunction

command! -nargs=+ RenameAny call RenameAnyVariable(<f-args>)
function! RenameAnyVariable(old_name, new_name)
    let pattern = escape(a:old_name, '\')
    let replace = escape(a:new_name, '\')
    execute '%s/'.pattern.'/'.replace.'/g'
endfunction


" set statusline=%F%m%r%h%w\ [%{&fileencoding}]\ %l/%L\ \|%c
highlight StatusLine ctermbg=blue ctermfg=blue
highlight StatusLineNC ctermbg=grey ctermfg=black


"for code suggestion menu, use Enter to choose next and use Tab to confrim
inoremap <expr> <Enter> pumvisible() ? "\<C-n>" : "\<Enter>"
inoremap <expr> <Tab> pumvisible() ? "\<C-y>" : "\<Tab>"


"set jumpoptions=stack
"xnoremap <leader>g :<C-u>Grep <C-R>=escape(@", ' ')<CR> *.c *.h<CR>
"vnoremap <leader>g y:Grep <C-R>" *.c *.cpp ..\Include\*.h<CR>:copen<CR>

"use \p to search highlighted keyword
vnoremap <leader>g y:Grep <C-R>" <CR>



"use shift+f to fold and unfold code
nnoremap <S-F> za
set foldmethod=syntax
set foldlevel=99

syntax enable



set diffexpr=MyDiff()
function! MyDiff()
  let opt = '-a --binary '
  if &diffopt =~ 'icase' | let opt = opt . '-i ' | endif
  if &diffopt =~ 'iwhite' | let opt = opt . '-b ' | endif
  let arg1 = v:fname_in
  if arg1 =~ ' ' | let arg1 = '"' . arg1 . '"' | endif
  let arg2 = v:fname_new
  if arg2 =~ ' ' | let arg2 = '"' . arg2 . '"' | endif
  let arg3 = v:fname_out
  if arg3 =~ ' ' | let arg3 = '"' . arg3 . '"' | endif
  let eq = ''
  if $VIMRUNTIME =~ ' '
    if &sh =~ '\<cmd'
      let cmd = '""' . $VIMRUNTIME . '\diff"'
      let eq = '"'
    else
      let cmd = substitute($VIMRUNTIME, ' ', '" ', '') . '\diff"'
    endif
  else
    let cmd = $VIMRUNTIME . '\diff'
  endif
  silent execute '!' . cmd . ' ' . opt . arg1 . ' ' . arg2 . ' > ' . arg3 . eq
endfunction

"popout menu color
"highlight Pmenu      ctermfg=white ctermbg=LightBlue guifg=#ffffff guibg=#444444
highlight Pmenu      ctermfg=white ctermbg=LightBlue guifg=#ffffff guibg=grey30
highlight PmenuSel   ctermfg=black ctermbg=yellow guifg=white guibg=MediumPurple
highlight FloatBorder guifg=#ffaa00 guibg=#444444
"make the file name bar look blue
highlight StatusLine guibg=#87afff guifg=black ctermbg=cyan ctermfg=white
highlight StatusLineNC guibg=grey50 guifg=black ctermbg=black ctermfg=grey
highlight QuickFixLine ctermbg=grey ctermfg=black guibg=DarkSeaGreen1 guifg=#000000

autocmd VimEnter * execute "split | resize " . (winheight(0) * 4/5)
autocmd VimEnter * execute "vsplit | vertical resize " . (winwidth(0) * 7/10)


"autocmd VimEnter * NERDTree
